<!DOCTYPE html>

<html>
	<head>
		<title>Spider Solitaire</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- CSS Files Link-->
		<link rel="stylesheet" type="text/css" href="css/reset.css">
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<link rel="stylesheet" type="text/css" href="css/cards.css">
	</head>
	<body>
		<div class = "home-screen">

			<button id="start-btn">
				<label>Start Game</label>
			</button>

		</div>
		<div class="game-title">
			<h1>Spider Solitaire</h1>
		</div>

		<form action = "index.html" name = "startGame" id = "startGame" class = "start-form">
			<div class="title">Choose a Difficulty Level</div>
			<label class="game-option">
				<input type="radio" name="radioBtn" value = "1" checked>
				<span class="suit one">One suit</span>
			</label>
			<label class="game-option">
				<input type="radio" name="radioBtn" value = "2">
				<span class="suit two">Two suits</span>
			</label>
			<label class="game-option">
				<input type="radio" name="radioBtn" value = "4">
				<span class="suit four">Four suits</span>
			</label>
			<input type="submit" value="Start">
		</form>


		<div class="congratulation">
			<canvas id="canvas">ttt</canvas>
		</div>

		<div class="wrapper">
			<div class="timer">
				<label>Time</label>
				<label id="minutes">00</label>:<label id="seconds">00</label>
			</div>
			<div class="score">
				<label>Moves: </label>
				<label id="score">0</label>
			</div>

			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>
			<ul class="column" data-height=""></ul>

			<div class="offside">
				<ul class="source" id="source"></ul>
				<ul class="dropout" id="dropout"></ul>
			</div>
		</div>

		<div class="control-panel opaque">
			<button class="btn-hint">Hint</button>
			<button class="btn-new">Restart Game</button>
			<button class="btn-pause">Pause Game</button>
			<button class="btnFaq" onclick="showFaq()">FAQ</button>			
		</div>

		<div id="faq" class="faq">
			<h1>Frequently Asked Questions</h1>

			<h2>Purpose of the game</h2>
			<p>Remove all 	cards from the playing field in the fewest moves.</p>

			<h2>Rules of the game</h2>
			<p>
				For solitaire, 2 decks of 52 cards are required. Initially, 54 cards are evenly decomposed into 10 columns  and the remaining 50 are added to 5 heaps of 10. In each column, all but the upper ones are closed. You can move cards from a column to a column. Maps are moved according to the following rules:
			</p>
			<ol>
				<li>On an empty space, you can move the top card of any column.</li>
				<li>The top card of the column can be moved to the next highest card, regardless of its suit and color.</li>
				<li>A stack of cards of the same suit, lying in order, can be moved as one card.</li>
			</ol>
			<p>
				If the top closed card of any column is released, it automatically opens. As soon as a column appears from the cards of the same suit collected in order, this column is removed into the house. Permitted at any time, when there are no empty columns, take one of the piles stacked on 10 cards and scatter these cards one at a time in each column.
			</p>
			<p>
				There are 3 levels of difficulty. On the first, all cards have the same suit - peaks (each card repeats 8 times); on the second, all cards have two different suits - peaks and hearts. At the last level of difficult	y, you will have to deal with two full decks with 4 suits.
			</p>
			<div class="faq-close" title="close" onclick="closeFaq()"></div>
		</div>
		<div class="faq-shadow"></div>

		<ul class="drag-el" id="drag-el"></ul>

		<script src="js/cardDeck.js"></script>
		<script src="js/cardDealer.js"></script>
		<script src="js/cardAnimation.js"></script>
		<script src="js/timeCounter.js"></script>
		<script src="js/script.js"></script>
		<script>
			var ctx = canvas.getContext("2d");
			var w = document.body.clientWidth;
			var h = document.body.clientHeight;
			canvas.width = w;
			canvas.height = h;

			var nodes = [];

			function draw() {
				requestAnimationFrame(draw);

				ctx.font = "72px OpenSans";
//				var gradient = ctx.createLinearGradient(0,0,c.width,0);
//				gradient.addColorStop("0","magenta");
//				gradient.addColorStop("0.5","blue");
//				gradient.addColorStop("1.0","red");
//				ctx.fillStyle = gradient;
				ctx.fillText("You Won!!!",500,300);

				ctx.globalCompositeOperation = "xor";
				ctx.fillStyle = "rgba(0, 0, 0, .03)";
				ctx.fillRect(0, 0, w, h);

				ctx.globalCompositeOperation = "lighter";

				var l = nodes.length,
						node;
				while (l--) {
					node = nodes[l];
					drawNode(node);
					if (node.dead) {
						nodes.splice(l, 1);
					}
				}

				if (nodes.length < 10) {
					l = rand(4, 1) | 0;
					while (l--) {
						nodes.push(
							makeNode(
								(Math.random() * w) | 0,
								(Math.random() * h) | 0,
								40,
								"hsl(" + (rand(300, 0) | 0) + ", 100%, 50%)",
								100
							)
						);
					}
				}
			}

			function drawNode(node) {
				var l = node.children.length,
						point;
				while (l--) {
					point = node.children[l];
					ctx.beginPath();
					ctx.fillStyle = point.color;
					ctx.arc(point.x, point.y, 1, 0, PI2);
					ctx.fill();
					ctx.closePath();
					updatePoint(point);
					if (point.dead) {
						node.children.splice(l, 1);
						if (node.count > 20) {
							nodes.push(
								makeNode(
									point.x,
									point.y,
									node.radius * 10,
									node.color,
									(node.count / 10) | 0
								)
							);
						}
					}
				}
				if (!node.children.length) {
					node.dead = true;
				}
			}

			function updatePoint(point) {
				var dx = point.x - point.dx;
				var dy = point.y - point.dy;
				var c = Math.sqrt(dx * dx + dy * dy);
				point.dead = c < 1;
				point.x -= dx * point.velocity;
				point.y -= dy * point.velocity;
			}

			const rad = Math.PI / 180;
			const PI2 = Math.PI * 2;
			var ttt = 0;

			function rand(max, min) {
				min = min || 0;
				return Math.random() * (max - min) + min;
			}

			function makeNode(x, y, radius, color, partCount) {
				radius = radius || 0;
				partCount = partCount || 0;
				var count = partCount;

				var children = [],
						kof,
						r;

				while (partCount--) {
					kof = (100 * Math.random()) | 0;
					r = (radius * Math.random()) | 0;
					children.push({
						x: x,
						y: y,
						dx: x + r * Math.cos(ttt * kof * rad),
						dy: y + r * Math.sin(ttt * kof * rad),
						color: color,
						velocity: rand(1, 0.05)
					});
					ttt++;
				}

				return {
					radius: radius,
					count: count,
					color: color,
					x: x,
					y: y,
					children: children
				};
			}

			draw();


		</script>
	</body>
</html>